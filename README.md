# Crypto Watcher (Bun)

Простой, настраиваемый инструмент командной строки для мониторинга цен на криптовалюту из терминала, построенный с использованием Bun и TypeScript. Приложение имеет модульную архитектуру, которая облегчает расширение и поддержку.

## Возможности

- Получает цены на криптовалюту в реальном времени из API **Binance**.
- Настраиваемый список криптовалют для отслеживания.
- Настраиваемый интервал получения данных (поддерживает секунды, минуты и часы).
- Цветной вывод для лучшей читаемости.

## Предварительные требования

- [Bun](https://bun.com) (v1.3.6 или новее)

## Установка

1.  Клонируйте репозиторий:

    ```bash
    git clone https://github.com/k4d/crypto-watcher-bun.git
    cd crypto-watcher-bun
    ```

2.  Установите зависимости:
    ```bash
    bun install
    ```

## Структура проекта

Проект организован в модульную структуру для лучшей поддерживаемости и масштабируемости:

```
/crypto-watcher-bun
├── src/
│   ├── api/                     # Модули для взаимодействия с внешними API (например, Binance)
│   │   ├── binance.ts           # Клиент Binance API
│   │   └── index.ts             # Агрегатор для API-клиентов
│   ├── config/                  # Модуль для загрузки и управления конфигурацией
│   │   └── index.ts             # Логика загрузки и обработки config.yml
│   ├── display/                 # Модуль для форматирования и вывода информации в консоль
│   │   └── index.ts             # Функции для логирования и форматирования вывода
│   ├── scheduler/               # Модуль для настройки и управления cron-заданиями
│   │   └── index.ts             # Логика планировщика
│   ├── types/                   # Централизованные определения общих типов и интерфейсов
│   │   └── index.ts             # Все общие типы
│   └── index.ts                 # Главный файл приложения (оркестратор)
├── config.yml                   # Файл конфигурации приложения
├── package.json                 # Описание проекта и скрипты
├── tsconfig.json                # Конфигурация TypeScript
├── biome.json                   # Конфигурация Biome для форматирования и линтинга
└── README.md                    # Документация проекта
```

## Конфигурация

1.  Создайте файл `config.yml` в **корне проекта**.
2.  Добавьте желаемую конфигурацию. Здесь приведен пример:

    ```yaml
    ---
    # Базовая валюта теперь является частью символа (например, BTCUSDT).
    # Это поле все еще может быть полезно для отображения.
    currency: USDT
    # Интервал, с которым запрашивать новые цены (s: секунды, m: минуты, h: часы)
    fetch_interval: 5m
    # Список криптовалют для отслеживания.
    # Ключ - это торговая пара API Binance (например, BTCUSDT), 
    # а значение - символ для отображения.
    coins:
      BTCUSDT: BTC
      ETHUSDT: ETH
      ZILUSDT: ZIL
      TONUSDT: TON
      TRXUSDT: TRX
      ZECUSDT: ZEC
    ```

## Использование

### Запуск в режиме разработки (Live Reload)

Для запуска приложения в режиме разработки с автоматической перезагрузкой при изменениях файлов:

```bash
bun run dev
```

### Запуск продакшен-версии

1.  **Создайте продакшен-сборку:**

    ```bash
    bun run build
    ```

2.  **Запустите скомпилированное приложение:**
    ```bash
    bun run start:prod
    ```

Приложение выполнит первоначальную выборку, а затем продолжит получать цены с интервалом, указанным в `config.yml`.

### Пример вывода

```
Crypto Watcher v1.0.0 started. Initial fetch...
Scheduler started: fetching every 1m

[1] Task run at 5:03:07 PM
┌───┬────────────┬─────────┬─────────────────────────┬─────────────────────────────┬─────┐
│   │ Symbol     │ Price   │ 24h High/Low/AVG        │ % Change 1m/15m/30m/Session │ V#  │
├───┼────────────┼─────────┼─────────────────────────┼─────────────────────────────┼─────┤
│ 1 │ BTC   USDT │ 95146.8 │ 95639.4 94876.3 95238.1 │ N/A N/A N/A N/A             │ N/A │
│ 2 │ ETH   USDT │ 3324.36 │ 3330.57 3296.34 3316.79 │ N/A N/A N/A N/A             │ N/A │
│ 3 │ ZIL   USDT │ 0.00569 │ 0.00609 0.00569 0.00587 │ N/A N/A N/A N/A             │ N/A │
│ 4 │ TON   USDT │ 1.714   │ 1.746   1.710   1.726   │ N/A N/A N/A N/A             │ N/A │
│ 5 │ TRX   USDT │ 0.3169  │ 0.3210  0.3138  0.3173  │ N/A N/A N/A N/A             │ N/A │
│ 6 │ ZEC   USDT │ 392.94  │ 406.05  386.34  397.78  │ N/A N/A N/A N/A             │ N/A │
└───┴────────────┴─────────┴─────────────────────────┴─────────────────────────────┴─────┘

[2] Task run at 5:04:00 PM
┌───┬────────────┬─────────┬─────────────────────────┬─────────────────────────────┬────┐
│   │ Symbol     │ Price   │ 24h High/Low/AVG        │ % Change 1m/15m/30m/Session │ V# │
├───┼────────────┼─────────┼─────────────────────────┼─────────────────────────────┼────┤
│ 1 │ BTC   USDT │ 95146.8 │ 95639.4 94876.3 95238.1 │ 0.00% 0.00% 0.00% 0.00%     │ 4  │
│ 2 │ ETH   USDT │ 3324.77 │ 3330.57 3296.34 3316.79 │ ▲ +0.01% N/A N/A ▲ +0.01%   │ 3  │
│ 3 │ ZIL   USDT │ 0.00569 │ 0.00609 0.00569 0.00587 │ 0.00% N/A N/A 0.00%         │ 5  │
│ 4 │ TON   USDT │ 1.714   │ 1.746   1.710   1.726   │ 0.00% N/A N/A 0.00%         │ 6  │
│ 5 │ TRX   USDT │ 0.3170  │ 0.3210  0.3138  0.3173  │ ▲ +0.03% N/A N/A ▲ +0.03%   │ 1  │
│ 6 │ ZEC   USDT │ 393.02  │ 406.05  386.34  397.77  │ ▲ +0.02% N/A N/A ▲ +0.02%   │ 2  │
└───┴────────────┴─────────┴─────────────────────────┴─────────────────────────────┴────┘
```

## Разработка

Проект использует [Biome](https://biomejs.dev/) для форматирования и линтинга кода.

- **Форматирование кода:**

  ```bash
  bun run format
  ```

- **Линтинг кода и применение исправлений:**
  ```bash
  bun run lint
  ```

## Тестирование

Проект использует встроенный тестовый ранер Bun (`bun:test`), совместимый с Jest `expect` синтаксисом.

Для запуска всех тестов:

```bash
bun run test
```
